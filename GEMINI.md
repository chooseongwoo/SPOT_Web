# GEMINI.md

> ì´ ë¬¸ì„œëŠ” Gemini CLIê°€ í”„ë¡œì íŠ¸ ìž‘ì—…ì„ ìˆ˜í–‰í•  ë•Œ ë°˜ë“œì‹œ ì°¸ê³ í•´ì•¼ í•  ê¸°ë³¸ ì›ì¹™ê³¼ êµ¬ì¡°ì  ê°€ì´ë“œë¥¼ ì •ì˜í•©ë‹ˆë‹¤.

---

## ðŸ§­ í”„ë¡œì íŠ¸ ê°œìš”

ë³¸ í”„ë¡œì íŠ¸ëŠ” Supabaseë¥¼ ë°±ì—”ë“œë¡œ ì‚¬ìš©í•˜ë©°, ì‚¬ìš©ìž ê¸°ë°˜ì˜ ë©”ì‹œì§€ì™€ íƒ€ìž„ìº¡ìŠ ì‹œìŠ¤í…œì„ ì¤‘ì‹¬ìœ¼ë¡œ êµ¬ì„±ë˜ì–´ ìžˆìŠµë‹ˆë‹¤. ê° ê¸°ëŠ¥ì€ ë³´ì•ˆ, ì‚¬ìš©ìž ê¶Œí•œ, êµ¬ì¡°ì  ì¼ê´€ì„±ì„ ìš°ì„ ìœ¼ë¡œ ì„¤ê³„ë˜ì–´ ìžˆìŠµë‹ˆë‹¤.

í”„ë¡ íŠ¸ì—”ë“œëŠ” Next.js ê¸°ë°˜ìœ¼ë¡œ êµ¬ì„±ë˜ì–´ ìžˆìœ¼ë©°, APIëŠ” Supabase Clientë¥¼ ì‚¬ìš©í•˜ì—¬ ì§ì ‘ í˜¸ì¶œí•˜ëŠ” ë°©ì‹ìž…ë‹ˆë‹¤.

---

## âš™ï¸ ê°œë°œ ì›ì¹™

- ê¸°ì¡´ ì½”ë“œ íë¦„, êµ¬ì¡°, ì»¨ë²¤ì…˜ì„ **ìµœìš°ì„ ìœ¼ë¡œ ì¡´ì¤‘**í•  ê²ƒ
- **ê¸°ì¡´ ê¸°ëŠ¥(User, History ë“±)**ì„ ì°¸ê³ í•˜ì—¬ ë™ì¼í•œ êµ¬ì¡°ì™€ íŒ¨í„´ìœ¼ë¡œ í™•ìž¥í•  ê²ƒ
- ë¶ˆí•„ìš”í•œ ë¦¬íŒ©í† ë§, ìž¬ì„¤ê³„, ìƒˆë¡œìš´ ì¶”ìƒí™” ë„ìž…ì€ **ì§€ì–‘**
- ê¸°ì¡´ ì½”ë“œì—ì„œ ì‚¬ìš© ì¤‘ì¸ ë¼ì´ë¸ŒëŸ¬ë¦¬, ìŠ¤íƒ€ì¼ ì‹œìŠ¤í…œ, ìœ í‹¸ í•¨ìˆ˜ ë“±ì„ ìš°ì„  í™œìš©

---

## ðŸ“ êµ¬ì¡°ì  í†µì¼ì„±

- **í´ë” êµ¬ì¡°, íŒŒì¼ ìœ„ì¹˜, ë„¤ì´ë°**ì€ ê¸°ì¡´ ì»´í¬ë„ŒíŠ¸ë“¤ê³¼ ì¼ê´€ë˜ê²Œ ìœ ì§€
- ë°ì´í„° ìš”ì²­ì€ Supabase Clientë¥¼ ì§ì ‘ ì‚¬ìš©í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ í†µì¼
- ìƒíƒœ ê´€ë¦¬ëŠ” Jotai ê¸°ë°˜ì˜ Atom êµ¬ì¡°ë¥¼ ìœ ì§€
- ê³µí†µ ì¸í„°íŽ˜ì´ìŠ¤, ëª¨ë¸, íƒ€ìž…ì€ ì¤‘ë³µ ì •ì˜ ì—†ì´ ê¸°ì¡´ íƒ€ìž…ì— í†µí•©

---

## ðŸ” ë°ì´í„°ë² ì´ìŠ¤ ë° ë³´ì•ˆ

- Supabaseì˜ í…Œì´ë¸” ìŠ¤í‚¤ë§ˆ ë° RLS ì •ì±…ì€ ì´ë¯¸ ì •ì˜ë˜ì–´ ìžˆìœ¼ë©°, ìž„ì˜ë¡œ ìˆ˜ì •í•˜ê±°ë‚˜ ì¶”ê°€í•˜ì§€ ë§ ê²ƒ
- ë°ì´í„° ê´€ë ¨ ë¡œì§ì€ ë°˜ë“œì‹œ Supabaseì˜ ì •ì±…ì„ ê¸°ë°˜ìœ¼ë¡œ ìž‘ì„±í•  ê²ƒ
- ì¸ì¦ëœ ì‚¬ìš©ìžë§Œ ì¡°ìž‘ ê°€ëŠ¥í•œ ë°ì´í„°ëŠ” `auth.uid()` ê¸°ì¤€ì˜ ì œì•½ì„ ì¤€ìˆ˜

---

## ðŸŽ¨ UI/UX

- ëª¨ë“  ë””ìžì¸ ìš”ì†ŒëŠ” í˜„ìž¬ í”„ë¡œì íŠ¸ì˜ ìŠ¤íƒ€ì¼ ì‹œìŠ¤í…œê³¼ í†µì¼ì„±ì„ ìœ ì§€í•´ì•¼ í•¨
- ë¶ˆí•„ìš”í•œ ìƒˆë¡œìš´ ìŠ¤íƒ€ì¼ ë„ìž…ì„ í”¼í•˜ê³ , ê¸°ì¡´ ì»´í¬ë„ŒíŠ¸(Button, Input ë“±) ìž¬ì‚¬ìš© ìš°ì„ 
- ì‹œê°ì  í‘œí˜„ì€ ë‹¤ë¥¸ íŽ˜ì´ì§€ë“¤ê³¼ì˜ **ìžì—°ìŠ¤ëŸ¬ìš´ í†µí•©**ì„ ëª©í‘œë¡œ í•¨

---

## ðŸš« í•˜ì§€ ë§ì•„ì•¼ í•  ê²ƒ

- ìƒˆë¡œìš´ ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬ ë˜ëŠ” ë””ìžì¸ ì‹œìŠ¤í…œ ë„ìž…
- ê¸°ì¡´ ìŠ¤í‚¤ë§ˆ ìˆ˜ì •, ìƒˆë¡œìš´ í…Œì´ë¸”/í•„ë“œ ìƒì„±
- ë¶ˆí•„ìš”í•œ ì½”ë“œ ë¦¬íŒ©í† ë§, ì•„í‚¤í…ì²˜ ë³€ê²½
- ê¸°ì¡´ êµ¬ì¡°ì™€ ì–´ìš¸ë¦¬ì§€ ì•ŠëŠ” ë…ë¦½ì  êµ¬í˜„

---

## âœ… í•µì‹¬ ëª©í‘œ

- ê¸°ì¡´ ì½”ë“œì— ìž˜ ë…¹ì•„ë“œëŠ” ê¸°ëŠ¥ ì¶”ê°€
- í†µì¼ì„± ìžˆëŠ” êµ¬ì¡°ì™€ ì¸í„°íŽ˜ì´ìŠ¤ ìœ ì§€
- Supabaseì™€ í˜„ìž¬ í”„ë¡œì íŠ¸ êµ¬ì¡°ì— ì •í™•ížˆ ë§žëŠ” ë°©ì‹ìœ¼ë¡œ ê°œë°œ

---

ë‹¤ìŒì€ Supabase êµ¬ì„± ì½”ë“œìž…ë‹ˆë‹¤.

```
create table if not exists public.users (
  id uuid primary key references auth.users(id) on delete cascade,
  nickname text not null unique,
  profile_image_url text not null,
  profile_complete boolean default false,
  created_at timestamp with time zone default now()
);

create table if not exists public.messages (
  id uuid primary key default uuid_generate_v4(),
  user_id uuid references public.users(id) on delete cascade,
  content text not null,
  lat float8 not null,
  lng float8 not null,
  is_time_capsule boolean default false,
  open_at timestamp with time zone,
  is_anonymous boolean default false,
  created_at timestamp with time zone default now(),
  image_url TEXT NOT NULL DEFAULT ''
);


create table if not exists public.message_views (
  id uuid primary key default uuid_generate_v4(),
  user_id uuid references public.users(id) on delete cascade,
  message_id uuid references public.messages(id) on delete cascade,
  viewed_at timestamp with time zone default now(),
  via_ar boolean default false
);

create table if not exists public.reactions (
  id bigint generated by default as identity primary key,
  created_at timestamptz not null default now(),
  user_id uuid not null references public.users(id) on delete cascade,
  message_id uuid not null references public.messages(id) on delete cascade,
  unique (user_id, message_id)
);

create table if not exists public.comments (
  id bigint generated by default as identity primary key,
  created_at timestamptz not null default now(),
  user_id uuid not null references public.users(id) on delete cascade,
  message_id uuid not null references public.messages(id) on delete cascade,
  content text not null check (char_length(content) > 0 and char_length(content) <= 500)
);

create table if not exists public.notices (
  id uuid primary key default uuid_generate_v4(),
  title text not null,
  content text not null,
  created_at timestamp with time zone default now()
);

alter table public.users enable row level security;

drop policy if exists "Select own user info" on public.users;
create policy "Select own user info" on public.users for select using (id = auth.uid());

drop policy if exists "Insert own user info" on public.users;
create policy "Insert own user info" on public.users for insert with check (id = auth.uid());

drop policy if exists "Update own user info" on public.users;
create policy "Update own user info" on public.users for update using (id = auth.uid());

drop policy if exists "Allow all users to read user profiles" on public.users;
create policy "Allow all users to read user profiles" on public.users for select using (true);

alter table public.messages enable row level security;

drop policy if exists "Select all messages" on public.messages;
create policy "Select all messages" on public.messages for select using (true);

drop policy if exists "Insert own messages" on public.messages;
create policy "Insert own messages" on public.messages for insert with check (user_id = auth.uid());

drop policy if exists "Update own messages" on public.messages;
create policy "Update own messages" on public.messages for update using (user_id = auth.uid());

drop policy if exists "Delete own messages" on public.messages;
create policy "Delete own messages" on public.messages for delete using (user_id = auth.uid());

alter table public.message_views enable row level security;

drop policy if exists "Select own message views" on public.message_views;
create policy "Select own message views" on public.message_views for select using (user_id = auth.uid());

drop policy if exists "Insert own message views" on public.message_views;
create policy "Insert own message views" on public.message_views for insert with check (user_id = auth.uid());

drop policy if exists "Delete own message views" on public.message_views;
create policy "Delete own message views" on public.message_views for delete using (user_id = auth.uid());

alter table public.reactions enable row level security;

drop policy if exists "Allow all users to read reactions" on public.reactions;
create policy "Allow all users to read reactions" on public.reactions for select using (true);

drop policy if exists "Allow authenticated users to insert their own reactions" on public.reactions;
create policy "Allow authenticated users to insert their own reactions" on public.reactions for insert with check (auth.uid() = user_id);

drop policy if exists "Allow authenticated users to delete their own reactions" on public.reactions;
create policy "Allow authenticated users to delete their own reactions" on public.reactions for delete using (auth.uid() = user_id);

alter table public.comments enable row level security;

drop policy if exists "Allow all users to read comments" on public.comments;
create policy "Allow all users to read comments" on public.comments for select using (true);

drop policy if exists "Allow authenticated users to insert their own comments" on public.comments;
create policy "Allow authenticated users to insert their own comments" on public.comments for insert with check (auth.uid() = user_id);

drop policy if exists "Allow users to update their own comments" on public.comments;
create policy "Allow users to update their own comments" on public.comments for update using (auth.uid() = user_id);

drop policy if exists "Allow users to delete their own comments" on public.comments;
create policy "Allow users to delete their own comments" on public.comments for delete using (auth.uid() = user_id);

alter table public.notices enable row level security;

drop policy if exists "Allow all users to read notices" on public.notices;
create policy "Allow all users to read notices" on public.notices for select using (true);
```

_GeminiëŠ” ìœ„ì˜ ê°€ì´ë“œë¼ì¸ì„ ê¸°ë°˜ìœ¼ë¡œ ìž‘ì—…ì„ ìˆ˜í–‰í•´ì•¼ í•˜ë©°, í”„ë¡œì íŠ¸ì˜ ê¸°ì¡´ íë¦„ì„ ë²—ì–´ë‚˜ì§€ ì•Šë„ë¡ ì£¼ì˜í•´ì•¼ í•©ë‹ˆë‹¤._
